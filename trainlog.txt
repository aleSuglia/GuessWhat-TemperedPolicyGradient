root@ip-172-31-5-25:~/workspace/GuessWhat-TemperedPolicyGradient# th oracle.lua --learningRate 0.0001 --epochs 30 --earlyStopThresh 10 --learningRateDecay 1e-7
{
  minLRate : 5e-05
  lookupDim : 300
  beamLen : 13
  learningRate : 0.0001
  batchSize : 64
  random : false
  startEpoch : 1
  saveLastModel : false
  imgFeatureSize : 4096
  hiddenSize : 512
  bestValid : 0
  modelPath : "model/"
  data_qas : "data/data_qas.h5"
  imgEmbedSize : 300
  dropout : 0
  learningRateDecay : 1e-07
  deviceId : 1
  verbose : false
  beamSize : 5
  useCuda : true
  debug : false
  epochs : 30
  DynamicTPG : false
  loadModel : false
  prefix : "1"
  inputImg : "data/data_img.h5"
  earlyStopThresh : 10
  inputIndex : "data/id2index.json"
  round : 8
  inputJson : "data/vocab.json"
  tempMax : 2
  temperatures : "{1}"
  tempMin : 0.5
  saveModel : true
  trainGuesser : true
}
Using GPU:1	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 25ms      
e:	1	s:	9058	Best valid accuracy: 0.0000 current accu: 0.7712	
e:	1	s:	9058	Test accuracy: 0.7680	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 25ms      
e:	2	s:	9058	Best valid accuracy: 0.7712 current accu: 0.7802	
e:	2	s:	9058	Test accuracy: 0.7784	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 26ms      
e:	3	s:	9058	Best valid accuracy: 0.7802 current accu: 0.7833	
e:	3	s:	9058	Test accuracy: 0.7814	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 26ms      
e:	4	s:	9058	Best valid accuracy: 0.7833 current accu: 0.7847	
e:	4	s:	9058	Test accuracy: 0.7829	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 26ms      
e:	5	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7844	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 26ms      
e:	6	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7826	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 26ms      
e:	7	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7799	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 26ms      
e:	8	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7773	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 25ms      
e:	9	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7752	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 26ms      
e:	10	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7738	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 25ms      
e:	11	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7709	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 25ms      
e:	12	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7699	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 25ms      
e:	13	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7677	
 [======================================== 9056/9056 ==================================>]  Tot: 3m55s | Step: 25ms      
e:	14	s:	9058	Best valid accuracy: 0.7847 current accu: 0.7655	
Early stopping at epoch: 14	
Best validation model TestSet confusion:	
ConfusionMatrix:
[[   52232   11573       8]   81.852% 	[class: No]
 [   12263   43223       4]   77.893% 	[class: Yes]
 [    1463    1165       7]]  0.266% 	[class: N/A]
 + average row correct: 53.336877531062% 
 + average rowUcol correct (VOC measure): 43.659169281212% 
 + global correct: 78.287326346176%


root@ip-172-31-5-25:~/workspace/GuessWhat-TemperedPolicyGradient# th guesser.lua --learningRate 0.0001 --epochs 30 --earlyStopThresh 10 --learningRateDecay 1e-7
{
  minLRate : 5e-05
  lookupDim : 300
  beamLen : 13
  learningRate : 0.0001
  batchSize : 64
  random : false
  startEpoch : 1
  saveLastModel : false
  imgFeatureSize : 4096
  hiddenSize : 512
  bestValid : 0
  modelPath : "model/"
  data_qas : "data/data_qas.h5"
  imgEmbedSize : 300
  dropout : 0
  learningRateDecay : 1e-07
  deviceId : 1
  verbose : false
  beamSize : 5
  useCuda : true
  debug : false
  epochs : 30
  DynamicTPG : false
  loadModel : false
  prefix : "1"
  inputImg : "data/data_img.h5"
  earlyStopThresh : 10
  inputIndex : "data/id2index.json"
  round : 8
  inputJson : "data/vocab.json"
  tempMax : 2
  temperatures : "{1}"
  tempMin : 0.5
  saveModel : true
  trainGuesser : true
}
Using GPU:1	
 [======================================== 1491/1491 ==================================>]  Tot: 3m28s | Step: 140ms     
e:	1	s:	1493	Best valid accuracy: 0.0000 current accu: 0.6003	
e:	1	s:	1493	Test accuracy: 0.5989	
 [======================================== 1491/1491 ==================================>]  Tot: 3m29s | Step: 140ms     
e:	2	s:	1493	Best valid accuracy: 0.6003 current accu: 0.6290	
e:	2	s:	1493	Test accuracy: 0.6238	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 140ms     
e:	3	s:	1493	Best valid accuracy: 0.6290 current accu: 0.6401	
e:	3	s:	1493	Test accuracy: 0.6320	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 140ms     
e:	4	s:	1493	Best valid accuracy: 0.6401 current accu: 0.6459	
e:	4	s:	1493	Test accuracy: 0.6395	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 140ms     
e:	5	s:	1493	Best valid accuracy: 0.6459 current accu: 0.6481	
e:	5	s:	1493	Test accuracy: 0.6453	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 141ms     
e:	6	s:	1493	Best valid accuracy: 0.6481 current accu: 0.6490	
e:	6	s:	1493	Test accuracy: 0.6462	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 140ms     
e:	7	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6470	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 140ms     
e:	8	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6470	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 140ms     
e:	9	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6481	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 141ms     
e:	10	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6479	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 141ms     
e:	11	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6440	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 141ms     
e:	12	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6434	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 141ms     
e:	13	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6428	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 141ms     
e:	14	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6405	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 141ms     
e:	15	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6434	
 [======================================== 1491/1491 ==================================>]  Tot: 3m30s | Step: 141ms     
e:	16	s:	1493	Best valid accuracy: 0.6490 current accu: 0.6392	
Early stopping at epoch: 16	
Final Test accuracy: 0.6462	

root@ip-172-31-5-25:~/workspace/GuessWhat-TemperedPolicyGradient# th qgen.lua --learningRate 0.001 --epochs 30 --earlyStopThresh 10 --learningRateDecay 0.5
{
  minLRate : 5e-05
  lookupDim : 300
  beamLen : 13
  learningRate : 0.001
  batchSize : 64
  random : false
  startEpoch : 1
  saveLastModel : false
  imgFeatureSize : 4096
  hiddenSize : 512
  bestValid : 0
  modelPath : "model/"
  data_qas : "data/data_qas.h5"
  imgEmbedSize : 300
  dropout : 0
  learningRateDecay : 0.5
  deviceId : 1
  verbose : false
  beamSize : 5
  useCuda : true
  debug : false
  epochs : 30
  DynamicTPG : false
  loadModel : false
  prefix : "1"
  inputImg : "data/data_img.h5"
  earlyStopThresh : 10
  inputIndex : "data/id2index.json"
  round : 8
  inputJson : "data/vocab.json"
  tempMax : 2
  temperatures : "{1}"
  tempMin : 0.5
  saveModel : true
  trainGuesser : true
}
Using GPU:1	
 [======================================== 8907/8907 ==================================>]  Tot: 54m11s | Step: 364ms    
e:	1	s:	8909	lr:	0.001	trainLoss	1.7969	
valid-loss: 1.937800	 Perplexity: 6.943800	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m16s | Step: 365ms    
e:	2	s:	8909	lr:	0.0005	trainLoss	1.6121	
valid-loss: 1.920400	 Perplexity: 6.823900	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m17s | Step: 365ms    
e:	3	s:	8909	lr:	0.00025	trainLoss	1.5027	
valid-loss: 1.876600	 Perplexity: 6.531100	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m17s | Step: 365ms    
e:	4	s:	8909	lr:	0.000125	trainLoss	1.4415	
valid-loss: 1.846800	 Perplexity: 6.339400	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m13s | Step: 365ms    
e:	5	s:	8909	lr:	6.25e-05	trainLoss	1.4085	
valid-loss: 1.825900	 Perplexity: 6.208300	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 365ms    
e:	6	s:	8909	lr:	3.125e-05	trainLoss	1.3915	
valid-loss: 1.820200	 Perplexity: 6.173200	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m11s | Step: 365ms    
e:	7	s:	8909	lr:	3.125e-05	trainLoss	1.3850	
valid-loss: 1.817500	 Perplexity: 6.156500	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m11s | Step: 365ms    
e:	8	s:	8909	lr:	3.125e-05	trainLoss	1.3783	
valid-loss: 1.815400	 Perplexity: 6.143700	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m10s | Step: 364ms    
e:	9	s:	8909	lr:	3.125e-05	trainLoss	1.3715	
valid-loss: 1.813200	 Perplexity: 6.130000	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m10s | Step: 364ms    
e:	10	s:	8909	lr:	3.125e-05	trainLoss	1.3648	
valid-loss: 1.810700	 Perplexity: 6.114500	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 365ms    
e:	11	s:	8909	lr:	3.125e-05	trainLoss	1.3581	
valid-loss: 1.808000	 Perplexity: 6.098500	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m16s | Step: 366ms    
e:	12	s:	8909	lr:	3.125e-05	trainLoss	1.3514	
valid-loss: 1.805200	 Perplexity: 6.081300	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m22s | Step: 366ms    
e:	13	s:	8909	lr:	3.125e-05	trainLoss	1.3447	
valid-loss: 1.802500	 Perplexity: 6.064500	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m22s | Step: 365ms    
e:	14	s:	8909	lr:	3.125e-05	trainLoss	1.3380	
valid-loss: 1.799900	 Perplexity: 6.048800	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m14s | Step: 365ms    
e:	15	s:	8909	lr:	3.125e-05	trainLoss	1.3314	
valid-loss: 1.797400	 Perplexity: 6.033900	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m13s | Step: 365ms    
e:	16	s:	8909	lr:	3.125e-05	trainLoss	1.3248	
valid-loss: 1.794700	 Perplexity: 6.017900	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m13s | Step: 365ms    
e:	17	s:	8909	lr:	3.125e-05	trainLoss	1.3182	
valid-loss: 1.792200	 Perplexity: 6.002500	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 364ms    
e:	18	s:	8909	lr:	3.125e-05	trainLoss	1.3117	
valid-loss: 1.789500	 Perplexity: 5.986300	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 364ms    
e:	19	s:	8909	lr:	3.125e-05	trainLoss	1.3051	
valid-loss: 1.786900	 Perplexity: 5.970900	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 365ms    
e:	20	s:	8909	lr:	3.125e-05	trainLoss	1.2985	
valid-loss: 1.784300	 Perplexity: 5.955300	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m11s | Step: 365ms    
e:	21	s:	8909	lr:	3.125e-05	trainLoss	1.2920	
valid-loss: 1.781800	 Perplexity: 5.940500	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 365ms    
e:	22	s:	8909	lr:	3.125e-05	trainLoss	1.2855	
valid-loss: 1.779200	 Perplexity: 5.925200	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m11s | Step: 365ms    
e:	23	s:	8909	lr:	3.125e-05	trainLoss	1.2790	
valid-loss: 1.776700	 Perplexity: 5.910400	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 365ms    
e:	24	s:	8909	lr:	3.125e-05	trainLoss	1.2725	
valid-loss: 1.774200	 Perplexity: 5.895700	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m11s | Step: 365ms    
e:	25	s:	8909	lr:	3.125e-05	trainLoss	1.2661	
valid-loss: 1.771800	 Perplexity: 5.881300	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 365ms    
e:	26	s:	8909	lr:	3.125e-05	trainLoss	1.2597	
valid-loss: 1.769400	 Perplexity: 5.867500	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 365ms    
e:	27	s:	8909	lr:	3.125e-05	trainLoss	1.2534	
valid-loss: 1.767100	 Perplexity: 5.853900	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 365ms    
e:	28	s:	8909	lr:	3.125e-05	trainLoss	1.2470	
valid-loss: 1.764700	 Perplexity: 5.840100	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m11s | Step: 364ms    
e:	29	s:	8909	lr:	3.125e-05	trainLoss	1.2407	
valid-loss: 1.762400	 Perplexity: 5.826500	
Saving model...	
 [======================================== 8907/8907 ==================================>]  Tot: 54m12s | Step: 365ms    
e:	30	s:	8909	lr:	3.125e-05	trainLoss	1.2344	
valid-loss: 1.760100	 Perplexity: 5.812800	
Saving model...


root@ip-172-31-5-25:~/workspace/GuessWhat-TemperedPolicyGradient# th reinforce.lua --temperatures '{1.0}' --epochs 80 --earlyStopThresh 20 --learningRate 0.001
{
  minLRate : 5e-05
  lookupDim : 300
  beamLen : 13
  learningRate : 0.001
  batchSize : 64
  random : false
  startEpoch : 1
  saveLastModel : false
  imgFeatureSize : 4096
  hiddenSize : 512
  bestValid : 0
  modelPath : "model/"
  data_qas : "data/data_qas.h5"
  imgEmbedSize : 300
  dropout : 0
  learningRateDecay : 1e-07
  deviceId : 1
  verbose : false
  beamSize : 5
  useCuda : true
  debug : false
  epochs : 80
  DynamicTPG : false
  loadModel : false
  prefix : "1"
  inputImg : "data/data_img.h5"
  earlyStopThresh : 20
  inputIndex : "data/id2index.json"
  round : 8
  inputJson : "data/vocab.json"
  tempMax : 2
  temperatures : "{1.0}"
  tempMin : 0.5
  saveModel : true
  trainGuesser : true
}
Using GPU:1	
 [======================================== 731/731 ====================================>]  Tot: 46m6s | Step: 3s741ms   
epoch	1	running_average	0.55857588579732	
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s125ms   
epoch	1	valid running_average	0.5648510889254	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s504ms  
epoch	2	running_average	0.5778304910886	
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s124ms   
epoch	2	valid running_average	0.55629975988879	
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s516ms  
epoch	3	running_average	0.6187118006582	
 [======================================== 370/370 ====================================>]  Tot: 7m1s | Step: 1s141ms    
epoch	3	valid running_average	0.63507308648216	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s513ms  
epoch	4	running_average	0.64450570585973	
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s118ms   
epoch	4	valid running_average	0.61965541935212	
 [======================================== 731/731 ====================================>]  Tot: 42m42s | Step: 3s516ms  
epoch	5	running_average	0.65322477240672	
 [======================================== 370/370 ====================================>]  Tot: 7m1s | Step: 1s142ms    
epoch	5	valid running_average	0.64206579889633	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m42s | Step: 3s524ms  
epoch	6	running_average	0.64807453947087	
 [======================================== 370/370 ====================================>]  Tot: 6m53s | Step: 1s123ms   
epoch	6	valid running_average	0.60259488605249	
 [======================================== 731/731 ====================================>]  Tot: 42m40s | Step: 3s505ms  
epoch	7	running_average	0.66070436380733	
 [======================================== 370/370 ====================================>]  Tot: 7m896ms | Step: 1s138ms 
epoch	7	valid running_average	0.66144319474283	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m31s | Step: 3s494ms  
epoch	8	running_average	0.67162456725221	
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s115ms   
epoch	8	valid running_average	0.66253843885589	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m28s | Step: 3s508ms  
epoch	9	running_average	0.67696713253836	
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s118ms   
epoch	9	valid running_average	0.65710434306416	
 [======================================== 731/731 ====================================>]  Tot: 42m31s | Step: 3s500ms  
epoch	10	running_average	0.67940334230884	
 [======================================== 370/370 ====================================>]  Tot: 7m854ms | Step: 1s138ms 
epoch	10	valid running_average	0.6735330047601	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m33s | Step: 3s517ms  
epoch	11	running_average	0.6815403684233	
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s114ms   
epoch	11	valid running_average	0.59206369265765	
 [======================================== 731/731 ====================================>]  Tot: 42m33s | Step: 3s497ms  
epoch	12	running_average	0.6764115057486	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s138ms   
epoch	12	valid running_average	0.6710897678925	
 [======================================== 731/731 ====================================>]  Tot: 42m32s | Step: 3s506ms  
epoch	13	running_average	0.68831474120614	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s135ms   
epoch	13	valid running_average	0.66691941530814	
 [======================================== 731/731 ====================================>]  Tot: 42m33s | Step: 3s494ms  
epoch	14	running_average	0.68500235072873	
 [======================================== 370/370 ====================================>]  Tot: 6m57s | Step: 1s130ms   
epoch	14	valid running_average	0.66645604279877	
utils.checkHistoryMemory: content wrong: . 257/74829....................................]  ETA: 27m35s | Step: 3s492ms  
 [======================================== 731/731 ====================================>]  Tot: 42m31s | Step: 3s503ms  
epoch	15	running_average	0.69081506176005	
 [======================================== 370/370 ====================================>]  Tot: 6m58s | Step: 1s132ms   
epoch	15	valid running_average	0.68322170268335	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m27s | Step: 3s492ms  
epoch	16	running_average	0.69149891011668	
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s113ms   
epoch	16	valid running_average	0.68650743502254	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m27s | Step: 3s494ms  
epoch	17	running_average	0.69329401205283	
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s110ms   
epoch	17	valid running_average	0.68360082564556	
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s500ms  
epoch	18	running_average	0.68910544086849	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s136ms   
epoch	18	valid running_average	0.68975104258815	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m42s | Step: 3s510ms  
epoch	19	running_average	0.68827200068385	
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s114ms   
epoch	19	valid running_average	0.68334807700409	
 [======================================== 731/731 ====================================>]  Tot: 42m47s | Step: 3s521ms  
epoch	20	running_average	0.68532290464589	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s135ms   
epoch	20	valid running_average	0.63545220944437	
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s518ms  
epoch	21	running_average	0.6554686498269	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s140ms   
epoch	21	valid running_average	0.64345591642445	
 [======================================== 731/731 ====================================>]  Tot: 42m49s | Step: 3s520ms  
epoch	22	running_average	0.65031841689105	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s136ms   
epoch	22	valid running_average	0.67336450566578	
 [======================================== 731/731 ====================================>]  Tot: 42m49s | Step: 3s523ms  
epoch	23	running_average	0.691840834295	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s137ms   
epoch	23	valid running_average	0.67795610598593	
 [======================================== 731/731 ====================================>]  Tot: 42m47s | Step: 3s521ms  
epoch	24	running_average	0.68773774415523	
 [======================================== 370/370 ====================================>]  Tot: 7m1s | Step: 1s143ms    
epoch	24	valid running_average	0.68014659421206	
 [======================================== 731/731 ====================================>]  Tot: 42m48s | Step: 3s524ms  
epoch	25	running_average	0.6963499593965	
 [======================================== 370/370 ====================================>]  Tot: 7m1s | Step: 1s140ms    
epoch	25	valid running_average	0.68082059058933	
 [======================================== 731/731 ====================================>]  Tot: 42m45s | Step: 3s520ms  
epoch	26	running_average	0.68901995982391	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s136ms   
epoch	26	valid running_average	0.62319390033278	
 [======================================== 731/731 ====================================>]  Tot: 42m49s | Step: 3s521ms  
epoch	27	running_average	0.68604949352481	
 [======================================== 370/370 ====================================>]  Tot: 7m107ms | Step: 1s137ms 
epoch	27	valid running_average	0.55962761700156	
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s512ms  
epoch	28	running_average	0.58398512629824	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s138ms   
epoch	28	valid running_average	0.57854164033868	
 [======================================== 731/731 ====================================>]  Tot: 42m45s | Step: 3s522ms  
epoch	29	running_average	0.60065392999103	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s135ms   
epoch	29	valid running_average	0.59004170352584	
utils.checkHistoryMemory: content wrong: . 313/74829....................................]  ETA: 24m24s | Step: 3s504ms  
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s515ms  
epoch	30	running_average	0.60779159721332	
 [======================================== 370/370 ====================================>]  Tot: 6m58s | Step: 1s134ms   
epoch	30	valid running_average	0.5866717216395	
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s518ms  
epoch	31	running_average	0.61725862290037	
 [======================================== 370/370 ====================================>]  Tot: 6m57s | Step: 1s133ms   
epoch	31	valid running_average	0.66856228147774	
 [======================================== 731/731 ====================================>]  Tot: 42m47s | Step: 3s521ms  
epoch	32	running_average	0.68626319613626	
 [======================================== 370/370 ====================================>]  Tot: 7m310ms | Step: 1s140ms 
epoch	32	valid running_average	0.66641391802519	
 [======================================== 731/731 ====================================>]  Tot: 42m49s | Step: 3s524ms  
epoch	33	running_average	0.68876351669017	
 [======================================== 370/370 ====================================>]  Tot: 7m365ms | Step: 1s136ms 
epoch	33	valid running_average	0.67972534647626	
 [======================================== 731/731 ====================================>]  Tot: 42m48s | Step: 3s525ms  
epoch	34	running_average	0.68987477026969	
 [======================================== 370/370 ====================================>]  Tot: 7m1s | Step: 1s142ms    
epoch	34	valid running_average	0.68427482202283	
 [======================================== 731/731 ====================================>]  Tot: 42m48s | Step: 3s522ms  
epoch	35	running_average	0.70115826815404	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s137ms   
epoch	35	valid running_average	0.68654955979612	
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s520ms  
epoch	36	running_average	0.70143608154892	
 [======================================== 370/370 ====================================>]  Tot: 6m58s | Step: 1s134ms   
epoch	36	valid running_average	0.68793967732423	
 [======================================== 731/731 ====================================>]  Tot: 42m48s | Step: 3s522ms  
epoch	37	running_average	0.6939992306706	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s135ms   
epoch	37	valid running_average	0.68528581658874	
 [======================================== 731/731 ====================================>]  Tot: 42m45s | Step: 3s524ms  
epoch	38	running_average	0.70023934692482	
 [======================================== 370/370 ====================================>]  Tot: 7m2s | Step: 1s142ms    
epoch	38	valid running_average	0.68907704621088	
 [======================================== 731/731 ====================================>]  Tot: 42m48s | Step: 3s517ms  
epoch	39	running_average	0.69861520707783	
 [======================================== 370/370 ====================================>]  Tot: 6m58s | Step: 1s132ms   
epoch	39	valid running_average	0.68587556341885	
 [======================================== 731/731 ====================================>]  Tot: 42m45s | Step: 3s520ms  
epoch	40	running_average	0.69882890968928	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s138ms   
epoch	40	valid running_average	0.69139390875774	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s513ms  
epoch	41	running_average	0.69842287472753	
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s112ms   
epoch	41	valid running_average	0.69236277855007	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s528ms  
epoch	42	running_average	0.70233363251699	
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s112ms   
epoch	42	valid running_average	0.69320527402165	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s517ms  
epoch	43	running_average	0.70442791810916	
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s113ms   
epoch	43	valid running_average	0.68878217279582	
 [======================================== 731/731 ====================================>]  Tot: 42m47s | Step: 3s523ms  
epoch	44	running_average	0.70620164978416	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s140ms   
epoch	44	valid running_average	0.69282615105944	
 [======================================== 731/731 ====================================>]  Tot: 42m44s | Step: 3s522ms  
epoch	45	running_average	0.70058127110313	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s138ms   
epoch	45	valid running_average	0.69510088883272	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s521ms  
epoch	46	running_average	0.70393640210283	
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s112ms   
epoch	46	valid running_average	0.69324739879523	
 [======================================== 731/731 ====================================>]  Tot: 42m45s | Step: 3s519ms  
epoch	47	running_average	0.70483395307091	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s141ms   
epoch	47	valid running_average	0.69716500273811	
Saving model...	
utils.checkHistoryMemory: content wrong: = 709/74829================================>...]  ETA: 1m17s | Step: 3s510ms   
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s520ms  
epoch	48	running_average	0.70697097918537	
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s117ms   
epoch	48	valid running_average	0.6977968743418	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s513ms  
epoch	49	running_average	0.70959952130615	
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s115ms   
epoch	49	valid running_average	0.69598550907789	
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s530ms  
epoch	50	running_average	0.7109672180194	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s135ms   
epoch	50	valid running_average	0.70095623236025	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m49s | Step: 3s519ms  
epoch	51	running_average	0.70974911313416	
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s112ms   
epoch	51	valid running_average	0.69927124141708	
 [======================================== 731/731 ====================================>]  Tot: 42m49s | Step: 3s517ms  
epoch	52	running_average	0.70912937556097	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s135ms   
epoch	52	valid running_average	0.69918699186992	
 [======================================== 731/731 ====================================>]  Tot: 42m51s | Step: 3s533ms  
epoch	53	running_average	0.70624439030645	
 [======================================== 370/370 ====================================>]  Tot: 7m351ms | Step: 1s137ms 
epoch	53	valid running_average	0.69628038249294	
 [======================================== 731/731 ====================================>]  Tot: 42m45s | Step: 3s520ms  
epoch	54	running_average	0.70891567294952	
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s126ms   
epoch	54	valid running_average	0.69889211845486	
 [======================================== 731/731 ====================================>]  Tot: 42m40s | Step: 3s516ms  
epoch	55	running_average	0.71421549771338	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s127ms   
epoch	55	valid running_average	0.70070348371877	
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s513ms  
epoch	56	running_average	0.71492071633115	
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s127ms   
epoch	56	valid running_average	0.69981886347361	
 [======================================== 731/731 ====================================>]  Tot: 42m42s | Step: 3s518ms  
epoch	57	running_average	0.71325383596188	
 [======================================== 370/370 ====================================>]  Tot: 6m58s | Step: 1s133ms   
epoch	57	valid running_average	0.69969248915287	
utils.checkHistoryMemory: content wrong: . 73/734829....................................]  ETA: 38m21s | Step: 3s497ms  
 [======================================== 731/731 ====================================>]  Tot: 42m40s | Step: 3s509ms  
epoch	58	running_average	0.71107406932513	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s128ms   
epoch	58	valid running_average	0.70070348371877	
 [======================================== 731/731 ====================================>]  Tot: 42m40s | Step: 3s513ms  
epoch	59	running_average	0.71180065820404	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s127ms   
epoch	59	valid running_average	0.6994397405114	
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s514ms  
epoch	60	running_average	0.71453605163055	
 [======================================== 370/370 ====================================>]  Tot: 6m57s | Step: 1s132ms   
epoch	60	valid running_average	0.7014617296432	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s511ms  
epoch	61	running_average	0.71521989998718	
 [======================================== 370/370 ====================================>]  Tot: 6m49s | Step: 1s109ms   
epoch	61	valid running_average	0.69017229032394	
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s516ms  
epoch	62	running_average	0.71205710133778	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s129ms   
epoch	62	valid running_average	0.70323097013354	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s515ms  
epoch	63	running_average	0.71519852972603	
 [======================================== 370/370 ====================================>]  Tot: 6m47s | Step: 1s101ms   
epoch	63	valid running_average	0.70196722692615	
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s512ms  
epoch	64	running_average	0.71449331110826	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s129ms   
epoch	64	valid running_average	0.70318884535996	
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s506ms  
epoch	65	running_average	0.71308287387272	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s127ms   
epoch	65	valid running_average	0.69783899911538	
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s517ms  
epoch	66	running_average	0.71511304868145	
 [======================================== 370/370 ====================================>]  Tot: 6m59s | Step: 1s137ms   
epoch	66	valid running_average	0.70184085260542	
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s508ms  
epoch	67	running_average	0.714749754242	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s129ms   
epoch	67	valid running_average	0.70259909852984	
 [======================================== 731/731 ====================================>]  Tot: 42m39s | Step: 3s509ms  
epoch	68	running_average	0.71660896696158	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s127ms   
epoch	68	valid running_average	0.70369434264291	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m39s | Step: 3s511ms  
epoch	69	running_average	0.71558319442664	
 [======================================== 370/370 ====================================>]  Tot: 6m49s | Step: 1s108ms   
epoch	69	valid running_average	0.70487383630313	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m39s | Step: 3s516ms  
epoch	70	running_average	0.71883147412061	
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s111ms   
epoch	70	valid running_average	0.70441046379376	
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s506ms  
epoch	71	running_average	0.71344616831218	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s127ms   
epoch	71	valid running_average	0.69712287796453	
 [======================================== 731/731 ====================================>]  Tot: 42m39s | Step: 3s512ms  
epoch	72	running_average	0.71530538103176	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s130ms   
epoch	72	valid running_average	0.7028939719449	
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s508ms  
epoch	73	running_average	0.71594648886609	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s129ms   
epoch	73	valid running_average	0.70613757951051	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m42s | Step: 3s517ms  
epoch	74	running_average	0.7105825533188	
 [======================================== 370/370 ====================================>]  Tot: 6m53s | Step: 1s118ms   
epoch	74	valid running_average	0.70243059943553	
 [======================================== 731/731 ====================================>]  Tot: 42m49s | Step: 3s517ms  
epoch	75	running_average	0.71385220327392	
 [======================================== 370/370 ====================================>]  Tot: 6m58s | Step: 1s132ms   
epoch	75	valid running_average	0.70369434264291	
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s512ms  
epoch	76	running_average	0.71902380647092	
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s125ms   
epoch	76	valid running_average	0.7031045958128	
 [======================================== 731/731 ====================================>]  Tot: 42m44s | Step: 3s515ms  
epoch	77	running_average	0.71821173654742	
 [======================================== 370/370 ====================================>]  Tot: 6m58s | Step: 1s141ms   
epoch	77	valid running_average	0.70470533720881	
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s524ms  
epoch	78	running_average	0.71611745095525	
 [======================================== 370/370 ====================================>]  Tot: 7m111ms | Step: 1s140ms 
epoch	78	valid running_average	0.70643245292557	
Saving model...	
 [======================================== 731/731 ====================================>]  Tot: 42m48s | Step: 3s516ms  
epoch	79	running_average	0.71372398170706	
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s116ms   
epoch	79	valid running_average	0.7014617296432	
 [======================================== 731/731 ====================================>]  Tot: 42m40s | Step: 3s506ms  
epoch	80	running_average	0.71289054152242	
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s131ms   
epoch	80	valid running_average	0.70259909852985	
 [======================================== 371/371 ====================================>]  Tot: 7m3s | Step: 1s137ms    
test running_average	0.6965734706748


root@ip-172-31-8-20:~/workspace/GuessWhat-TemperedPolicyGradient# th reinforce.lua --temperatures '{1.5}' --epochs 80 --earlyStopThresh 20 --learningRate 0.001
{
  minLRate : 5e-05
  lookupDim : 300
  beamLen : 13
  learningRate : 0.001
  batchSize : 64
  random : false
  startEpoch : 1
  saveLastModel : false
  imgFeatureSize : 4096
  hiddenSize : 512
  bestValid : 0
  modelPath : "model/"
  data_qas : "data/data_qas.h5"
  imgEmbedSize : 300
  dropout : 0
  learningRateDecay : 1e-07
  deviceId : 1
  verbose : false
  beamSize : 5
  useCuda : true
  debug : false
  epochs : 80
  DynamicTPG : false
  loadModel : false
  prefix : "1"
  inputImg : "data/data_img.h5"
  earlyStopThresh : 20
  inputIndex : "data/id2index.json"
  round : 8
  inputJson : "data/vocab.json"
  tempMax : 2
  temperatures : "{1.5}"
  tempMin : 0.5
  saveModel : true
  trainGuesser : true
}
Using GPU:1 
 [======================================== 731/731 ====================================>]  Tot: 50m16s | Step: 4s90ms   
epoch 1 running_average 0.53951361285635  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s343ms   
epoch 1 valid running_average 0.46362525801424  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m23s | Step: 3s736ms  
epoch 2 running_average 0.5685344274907 
 [======================================== 370/370 ====================================>]  Tot: 8m12s | Step: 1s340ms   
epoch 2 valid running_average 0.59143182105396  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m24s | Step: 3s736ms  
epoch 3 running_average 0.62999529854255  
 [======================================== 370/370 ====================================>]  Tot: 8m18s | Step: 1s351ms   
epoch 3 valid running_average 0.62530013901175  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m13s | Step: 3s696ms  
epoch 4 running_average 0.64555284865581  
 [======================================== 370/370 ====================================>]  Tot: 8m4s | Step: 1s304ms    
epoch 4 valid running_average 0.634988836935  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m57s | Step: 3s718ms  
epoch 5 running_average 0.64634354831816  
 [======================================== 370/370 ====================================>]  Tot: 8m3s | Step: 1s308ms    
epoch 5 valid running_average 0.5976662875437 
 [======================================== 731/731 ====================================>]  Tot: 44m54s | Step: 3s695ms  
epoch 6 running_average 0.65867418899859  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s336ms   
epoch 6 valid running_average 0.65689371919626  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m45s | Step: 3s681ms  
epoch 7 running_average 0.6722443048254 
 [======================================== 370/370 ====================================>]  Tot: 8m3s | Step: 1s311ms    
epoch 7 valid running_average 0.66670879144025  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m42s | Step: 3s681ms  
epoch 8 running_average 0.67361200153866  
 [======================================== 370/370 ====================================>]  Tot: 8m666ms | Step: 1s304ms 
epoch 8 valid running_average 0.66649816757235  
 [======================================== 731/731 ====================================>]  Tot: 44m41s | Step: 3s680ms  
epoch 9 running_average 0.68109159293927  
 [======================================== 370/370 ====================================>]  Tot: 8m8s | Step: 1s323ms    
epoch 9 valid running_average 0.66338093432748  
 [======================================== 731/731 ====================================>]  Tot: 44m44s | Step: 3s691ms  
epoch 10  running_average 0.68335684062059  
 [======================================== 370/370 ====================================>]  Tot: 8m11s | Step: 1s331ms   
epoch 10  valid running_average 0.66224356544084  
 [======================================== 731/731 ====================================>]  Tot: 44m53s | Step: 3s704ms  
epoch 11  running_average 0.68369876479891  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s340ms   
epoch 11  valid running_average 0.66953115127006  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m58s | Step: 3s701ms  
epoch 12  running_average 0.68568619908535  
 [======================================== 370/370 ====================================>]  Tot: 8m3s | Step: 1s315ms    
epoch 12  valid running_average 0.65529297780024  
 [======================================== 731/731 ====================================>]  Tot: 44m56s | Step: 3s691ms  
epoch 13  running_average 0.68771637389409  
 [======================================== 370/370 ====================================>]  Tot: 8m11s | Step: 1s332ms   
epoch 13  valid running_average 0.68216858334386  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m54s | Step: 3s706ms  
epoch 14  running_average 0.69953412830705  
 [======================================== 370/370 ====================================>]  Tot: 8m4s | Step: 1s309ms    
epoch 14  valid running_average 0.69278402628586  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m59s | Step: 3s703ms  
epoch 15  running_average 0.69515322477241  
 [======================================== 370/370 ====================================>]  Tot: 8m5s | Step: 1s315ms    
epoch 15  valid running_average 0.57651965120687  
 [======================================== 731/731 ====================================>]  Tot: 44m56s | Step: 3s703ms  
epoch 16  running_average 0.65525494721545  
 [======================================== 370/370 ====================================>]  Tot: 8m11s | Step: 1s330ms   
epoch 16  valid running_average 0.68541219090947  
 [======================================== 731/731 ====================================>]  Tot: 44m55s | Step: 3s699ms  
epoch 17  running_average 0.69352908492542  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s336ms   
epoch 17  valid running_average 0.68928767007877  
 [======================================== 731/731 ====================================>]  Tot: 44m56s | Step: 3s697ms  
epoch 18  running_average 0.70214130016669  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s341ms   
epoch 18  valid running_average 0.68056784194785  
 [======================================== 731/731 ====================================>]  Tot: 44m56s | Step: 3s702ms  
epoch 19  running_average 0.68598538274138  
 [======================================== 370/370 ====================================>]  Tot: 8m12s | Step: 1s335ms   
epoch 19  valid running_average 0.67247988542062  
 [======================================== 731/731 ====================================>]  Tot: 45m7s | Step: 3s707ms   
epoch 20  running_average 0.69164850194469  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s339ms   
epoch 20  valid running_average 0.68208433379671  
 [======================================== 731/731 ====================================>]  Tot: 45m2s | Step: 3s717ms   
epoch 21  running_average 0.69607214600162  
 [======================================== 370/370 ====================================>]  Tot: 8m14s | Step: 1s342ms   
epoch 21  valid running_average 0.67462824887316  
 [======================================== 731/731 ====================================>]  Tot: 44m58s | Step: 3s701ms  
epoch 22  running_average 0.69897850151729  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s334ms   
epoch 22  valid running_average 0.68756055436202  
 [======================================== 731/731 ====================================>]  Tot: 45m12s | Step: 3s718ms  
epoch 23  running_average 0.70177800572723  
 [======================================== 370/370 ====================================>]  Tot: 8m19s | Step: 1s355ms   
epoch 23  valid running_average 0.68945616917309  
 [======================================== 731/731 ====================================>]  Tot: 45m12s | Step: 3s731ms  
epoch 24  running_average 0.69605077574048  
 [======================================== 370/370 ====================================>]  Tot: 8m18s | Step: 1s352ms   
epoch 24  valid running_average 0.68296895404187  
 [======================================== 731/731 ====================================>]  Tot: 45m18s | Step: 3s728ms  
epoch 25  running_average 0.70094456554259  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s342ms   
epoch 25  valid running_average 0.68878217279582  
 [======================================== 731/731 ====================================>]  Tot: 45m19s | Step: 3s731ms  
epoch 26  running_average 0.70250459460615  
 [======================================== 370/370 ====================================>]  Tot: 8m19s | Step: 1s355ms   
epoch 26  valid running_average 0.68423269724925  
 [======================================== 731/731 ====================================>]  Tot: 45m16s | Step: 3s723ms  
epoch 27  running_average 0.70254733512844  
 [======================================== 370/370 ====================================>]  Tot: 8m18s | Step: 1s349ms   
epoch 27  valid running_average 0.68558069000379  
 [======================================== 731/731 ====================================>]  Tot: 45m12s | Step: 3s723ms  
epoch 28  running_average 0.70062401162542  
 [======================================== 370/370 ====================================>]  Tot: 8m19s | Step: 1s356ms   
epoch 28  valid running_average 0.69286827583302  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m13s | Step: 3s726ms  
epoch 29  running_average 0.70361584818566  
 [======================================== 370/370 ====================================>]  Tot: 8m6s | Step: 1s320ms    
epoch 29  valid running_average 0.68869792324866  
 [======================================== 731/731 ====================================>]  Tot: 45m16s | Step: 3s714ms  
epoch 30  running_average 0.71047570201308  
 [======================================== 370/370 ====================================>]  Tot: 8m18s | Step: 1s345ms   
epoch 30  valid running_average 0.6916887821728 
 [======================================== 731/731 ====================================>]  Tot: 45m15s | Step: 3s725ms  
epoch 31  running_average 0.70585972560585  
 [======================================== 370/370 ====================================>]  Tot: 8m21s | Step: 1s350ms   
epoch 31  valid running_average 0.6916887821728 
 [======================================== 731/731 ====================================>]  Tot: 45m2s | Step: 3s702ms   
epoch 32  running_average 0.70874471086037  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s351ms   
epoch 32  valid running_average 0.69425839336114  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m4s | Step: 3s722ms   
epoch 33  running_average 0.70906526477754  
 [======================================== 370/370 ====================================>]  Tot: 8m10s | Step: 1s323ms   
epoch 33  valid running_average 0.6963646320401 
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m1s | Step: 3s711ms   
epoch 34  running_average 0.70759071675856  
 [======================================== 370/370 ====================================>]  Tot: 8m6s | Step: 1s317ms    
epoch 34  valid running_average 0.69185728126711  
 [======================================== 731/731 ====================================>]  Tot: 44m59s | Step: 3s708ms  
epoch 35  running_average 0.70853100824892  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s344ms   
epoch 35  valid running_average 0.69518513837988  
 [======================================== 731/731 ====================================>]  Tot: 45m3s | Step: 3s706ms   
epoch 36  running_average 0.71068940462453  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s338ms   
epoch 36  valid running_average 0.69569063566283  
 [======================================== 731/731 ====================================>]  Tot: 44m54s | Step: 3s700ms  
epoch 37  running_average 0.70752660597513  
 [======================================== 370/370 ====================================>]  Tot: 8m14s | Step: 1s341ms   
epoch 37  valid running_average 0.69674375500232  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m48s | Step: 3s697ms  
epoch 38  running_average 0.71167243663718  
 [======================================== 370/370 ====================================>]  Tot: 8m3s | Step: 1s307ms    
epoch 38  valid running_average 0.69581700998357  
 [======================================== 731/731 ====================================>]  Tot: 44m52s | Step: 3s696ms  
epoch 39  running_average 0.70925759712784  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s343ms   
epoch 39  valid running_average 0.69729137705885  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m45s | Step: 3s683ms  
epoch 40  running_average 0.71175791768175  
 [======================================== 370/370 ====================================>]  Tot: 8m2s | Step: 1s307ms    
epoch 40  valid running_average 0.69821812207759  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m52s | Step: 3s697ms  
epoch 41  running_average 0.71060392357995  
 [======================================== 370/370 ====================================>]  Tot: 8m6s | Step: 1s321ms    
epoch 41  valid running_average 0.69219427945575  
 [======================================== 731/731 ====================================>]  Tot: 44m56s | Step: 3s703ms  
epoch 42  running_average 0.70923622686669  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s329ms   
epoch 42  valid running_average 0.69729137705885  
 [======================================== 731/731 ====================================>]  Tot: 44m52s | Step: 3s693ms  
epoch 43  running_average 0.71406590588537  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s337ms   
epoch 43  valid running_average 0.7002401112094 
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m53s | Step: 3s692ms  
epoch 44  running_average 0.71460016241399  
 [======================================== 370/370 ====================================>]  Tot: 8m4s | Step: 1s314ms    
epoch 44  valid running_average 0.69973461392645  
 [======================================== 731/731 ====================================>]  Tot: 44m58s | Step: 3s699ms  
epoch 45  running_average 0.71180065820404  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s342ms   
epoch 45  valid running_average 0.70171447828468  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m57s | Step: 3s709ms  
epoch 46  running_average 0.70932170791127  
 [======================================== 370/370 ====================================>]  Tot: 8m6s | Step: 1s317ms    
epoch 46  valid running_average 0.69767050002106  
 [======================================== 731/731 ====================================>]  Tot: 45m5s | Step: 3s708ms   
epoch 47  running_average 0.70850963798778  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s346ms   
epoch 47  valid running_average 0.69729137705885  
 [======================================== 731/731 ====================================>]  Tot: 44m59s | Step: 3s718ms  
epoch 48  running_average 0.71203573107663  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s365ms   
epoch 48  valid running_average 0.70179872783184  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m12s | Step: 3s716ms  
epoch 49  running_average 0.71051844253537  
 [======================================== 370/370 ====================================>]  Tot: 8m7s | Step: 1s321ms    
epoch 49  valid running_average 0.6977968743418 
 [======================================== 731/731 ====================================>]  Tot: 45m1s | Step: 3s710ms   
epoch 50  running_average 0.71299739282814  
 [======================================== 370/370 ====================================>]  Tot: 8m14s | Step: 1s343ms   
epoch 50  valid running_average 0.70221997556763  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m1s | Step: 3s712ms   
epoch 51  running_average 0.71370261144591  
 [======================================== 370/370 ====================================>]  Tot: 8m8s | Step: 1s324ms    
epoch 51  valid running_average 0.70095623236025  
 [======================================== 731/731 ====================================>]  Tot: 45m3s | Step: 3s712ms   
epoch 52  running_average 0.70996281574561  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s351ms   
epoch 52  valid running_average 0.70171447828468  
 [======================================== 731/731 ====================================>]  Tot: 45m2s | Step: 3s713ms   
epoch 53  running_average 0.70970637261187  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s348ms   
epoch 53  valid running_average 0.69712287796453  
 [======================================== 731/731 ====================================>]  Tot: 45m10s | Step: 3s731ms  
epoch 54  running_average 0.70846689746549  
 [======================================== 370/370 ====================================>]  Tot: 8m19s | Step: 1s356ms   
epoch 54  valid running_average 0.69834449639833  
 [======================================== 731/731 ====================================>]  Tot: 45m11s | Step: 3s719ms  
epoch 55  running_average 0.71128777193657  
 [======================================== 370/370 ====================================>]  Tot: 8m18s | Step: 1s349ms   
epoch 55  valid running_average 0.69855512026623  
 [======================================== 731/731 ====================================>]  Tot: 45m9s | Step: 3s716ms   
epoch 56  running_average 0.71199299055435  
 [======================================== 370/370 ====================================>]  Tot: 8m20s | Step: 1s357ms   
epoch 56  valid running_average 0.70104048190741  
 [======================================== 731/731 ====================================>]  Tot: 45m8s | Step: 3s710ms   
epoch 57  running_average 0.71406590588537  
 [======================================== 370/370 ====================================>]  Tot: 8m18s | Step: 1s351ms   
epoch 57  valid running_average 0.70104048190741  
 [======================================== 731/731 ====================================>]  Tot: 45m6s | Step: 3s712ms   
epoch 58  running_average 0.71321109543959  
 [======================================== 370/370 ====================================>]  Tot: 8m17s | Step: 1s347ms   
epoch 58  valid running_average 0.70293609671848  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m12s | Step: 3s717ms  
epoch 59  running_average 0.71338205752874  
 [======================================== 370/370 ====================================>]  Tot: 8m7s | Step: 1s321ms    
epoch 59  valid running_average 0.70196722692616  
 [======================================== 731/731 ====================================>]  Tot: 45m8s | Step: 3s718ms   
epoch 60  running_average 0.70987733470103  
 [======================================== 370/370 ====================================>]  Tot: 8m19s | Step: 1s357ms   
epoch 60  valid running_average 0.70032436075656  
 [======================================== 731/731 ====================================>]  Tot: 45m19s | Step: 3s732ms  
epoch 61  running_average 0.71261272812754  
 [======================================== 370/370 ====================================>]  Tot: 8m19s | Step: 1s356ms   
epoch 61  valid running_average 0.70171447828468  
 [======================================== 731/731 ====================================>]  Tot: 45m14s | Step: 3s724ms  
epoch 62  running_average 0.70840278668205  
 [======================================== 370/370 ====================================>]  Tot: 8m20s | Step: 1s353ms   
epoch 62  valid running_average 0.70280972239774  
 [======================================== 731/731 ====================================>]  Tot: 45m16s | Step: 3s719ms  
epoch 63  running_average 0.7115869555926 
 [======================================== 370/370 ====================================>]  Tot: 8m19s | Step: 1s351ms   
epoch 63  valid running_average 0.70019798643582  
 [======================================== 731/731 ====================================>]  Tot: 45m11s | Step: 3s712ms  
epoch 64  running_average 0.71385220327392  
 [======================================== 370/370 ====================================>]  Tot: 8m18s | Step: 1s352ms   
epoch 64  valid running_average 0.70483171152955  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m56s | Step: 3s692ms  
epoch 65  running_average 0.71628841304441  
 [======================================== 370/370 ====================================>]  Tot: 8m6s | Step: 1s315ms    
epoch 65  valid running_average 0.70550570790682  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 44m58s | Step: 3s703ms  
epoch 66  running_average 0.71786981236911  
 [======================================== 370/370 ====================================>]  Tot: 8m1s | Step: 1s304ms    
epoch 66  valid running_average 0.69927124141708  
 [======================================== 731/731 ====================================>]  Tot: 45m3s | Step: 3s707ms   
epoch 67  running_average 0.71722870453477  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s341ms   
epoch 67  valid running_average 0.70352584354859  
 [======================================== 731/731 ====================================>]  Tot: 45m3s | Step: 3s714ms   
epoch 68  running_average 0.71528401077061  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s342ms   
epoch 68  valid running_average 0.70445258856734  
 [======================================== 731/731 ====================================>]  Tot: 45m6s | Step: 3s718ms   
epoch 69  running_average 0.71825447706971  
 [======================================== 370/370 ====================================>]  Tot: 8m20s | Step: 1s358ms   
epoch 69  valid running_average 0.70356796832217  
 [======================================== 731/731 ====================================>]  Tot: 45m12s | Step: 3s711ms  
epoch 70  running_average 0.72030602213959  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s346ms   
epoch 70  valid running_average 0.70259909852985  
 [======================================== 731/731 ====================================>]  Tot: 45m2s | Step: 3s708ms   
epoch 71  running_average 0.71483523528658  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s341ms   
epoch 71  valid running_average 0.70580058132188  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m1s | Step: 3s711ms   
epoch 72  running_average 0.71748514766851  
 [======================================== 370/370 ====================================>]  Tot: 8m2s | Step: 1s301ms    
epoch 72  valid running_average 0.70112473145457  
 [======================================== 731/731 ====================================>]  Tot: 45m11s | Step: 3s761ms  
epoch 73  running_average 0.71921613882122  
 [======================================== 370/370 ====================================>]  Tot: 8m18s | Step: 1s350ms   
epoch 73  valid running_average 0.70137748009604  
 [======================================== 731/731 ====================================>]  Tot: 45m7s | Step: 3s714ms   
epoch 74  running_average 0.71799803393598  
 [======================================== 370/370 ====================================>]  Tot: 8m19s | Step: 1s354ms   
epoch 74  valid running_average 0.70622182905767  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 45m11s | Step: 3s711ms  
epoch 75  running_average 0.71827584733086  
 [======================================== 370/370 ====================================>]  Tot: 8m10s | Step: 1s324ms   
epoch 75  valid running_average 0.70184085260542  
 [======================================== 731/731 ====================================>]  Tot: 45m8s | Step: 3s713ms   
epoch 76  running_average 0.71876736333718  
 [======================================== 370/370 ====================================>]  Tot: 8m17s | Step: 1s350ms   
epoch 76  valid running_average 0.70200935169973  
 [======================================== 731/731 ====================================>]  Tot: 45m9s | Step: 3s717ms   
epoch 77  running_average 0.718297217592  
 [======================================== 370/370 ====================================>]  Tot: 8m17s | Step: 1s345ms   
epoch 77  valid running_average 0.70567420700114  
 [======================================== 731/731 ====================================>]  Tot: 45m2s | Step: 3s704ms   
epoch 78  running_average 0.71928024960465  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s337ms   
epoch 78  valid running_average 0.7043262142466 
 [======================================== 731/731 ====================================>]  Tot: 45m2s | Step: 3s708ms   
epoch 79  running_average 0.71673718852844  
 [======================================== 370/370 ====================================>]  Tot: 8m14s | Step: 1s339ms   
epoch 79  valid running_average 0.70407346560512  
 [======================================== 731/731 ====================================>]  Tot: 45m1s | Step: 3s709ms   
epoch 80  running_average 0.71761336923537  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s341ms   
epoch 80  valid running_average 0.7055478326804 
 [======================================== 371/371 ====================================>]  Tot: 8m21s | Step: 1s352ms   
test running_average  0.69758250998528


root@ip-172-31-12-51:~/workspace/GuessWhat-TemperedPolicyGradient# th reinforce.lua --temperatures '{1.0, 1.5}' --epochs 80 --earlyStopThresh 20 --learningRate 0.001
{
  minLRate : 5e-05
  lookupDim : 300
  beamLen : 13
  learningRate : 0.001
  batchSize : 64
  random : false
  startEpoch : 1
  saveLastModel : false
  imgFeatureSize : 4096
  hiddenSize : 512
  bestValid : 0
  modelPath : "model/"
  data_qas : "data/data_qas.h5"
  imgEmbedSize : 300
  dropout : 0
  learningRateDecay : 1e-07
  deviceId : 1
  verbose : false
  beamSize : 5
  useCuda : true
  debug : false
  epochs : 80
  DynamicTPG : false
  loadModel : false
  prefix : "1"
  inputImg : "data/data_img.h5"
  earlyStopThresh : 20
  inputIndex : "data/id2index.json"
  round : 8
  inputJson : "data/vocab.json"
  tempMax : 2
  temperatures : "{1.0, 1.5}"
  tempMin : 0.5
  saveModel : true
  trainGuesser : true
}
Using GPU:1 
 [======================================== 731/731 ====================================>]  Tot: 1h27m | Step: 7s98ms    
epoch 1 running_average 0.56235842201992  
 [======================================== 370/370 ====================================>]  Tot: 8m17s | Step: 1s347ms   
epoch 1 valid running_average 0.54273558279624  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s584ms   
epoch 2 running_average 0.58663503868017  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s345ms   
epoch 2 valid running_average 0.59939340326046  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s571ms   
epoch 3 running_average 0.62518698978501  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s342ms   
epoch 3 valid running_average 0.63486246261426  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s597ms   
epoch 4 running_average 0.65446424755311  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s343ms   
epoch 4 valid running_average 0.6596739542525 
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s623ms   
epoch 5 running_average 0.66521348890884  
 [======================================== 370/370 ====================================>]  Tot: 8m19s | Step: 1s354ms   
epoch 5 valid running_average 0.62487889127596  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s550ms   
epoch 6 running_average 0.67972389622601  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s368ms   
epoch 6 valid running_average 0.66628754370445  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s573ms   
epoch 7 running_average 0.69228960977903  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s344ms   
epoch 7 valid running_average 0.67879860145752  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s544ms   
epoch 8 running_average 0.69021669444801  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s334ms   
epoch 8 valid running_average 0.66295968659168  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s554ms   
epoch 9 running_average 0.70840278668205  
 [======================================== 370/370 ====================================>]  Tot: 8m25s | Step: 1s366ms   
epoch 9 valid running_average 0.69548001179494  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s588ms   
epoch 10  running_average 0.69829465316066  
 [======================================== 370/370 ====================================>]  Tot: 8m12s | Step: 1s335ms   
epoch 10  valid running_average 0.70744344749147  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s577ms   
epoch 11  running_average 0.71898106594863  
 [======================================== 370/370 ====================================>]  Tot: 8m12s | Step: 1s333ms   
epoch 11  valid running_average 0.70769619613295  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s594ms   
epoch 12  running_average 0.71772022054109  
 [======================================== 370/370 ====================================>]  Tot: 8m14s | Step: 1s338ms   
epoch 12  valid running_average 0.70584270609546  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s591ms   
epoch 13  running_average 0.72609736290978  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s365ms   
epoch 13  valid running_average 0.70605332996335  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s597ms   
epoch 14  running_average 0.72415266914562  
 [======================================== 370/370 ====================================>]  Tot: 8m25s | Step: 1s368ms   
epoch 14  valid running_average 0.71536290492439  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s587ms   
epoch 15  running_average 0.72731546779502  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s335ms   
epoch 15  valid running_average 0.71009730822697  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s577ms   
epoch 16  running_average 0.73376928666068  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s365ms   
epoch 16  valid running_average 0.71359366443405  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s599ms   
epoch 17  running_average 0.72851220241911  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s367ms   
epoch 17  valid running_average 0.71523653060365  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s589ms   
epoch 18  running_average 0.7356926101637 
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s363ms   
epoch 18  valid running_average 0.72235561733856  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s588ms   
epoch 19  running_average 0.73774415523358  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s340ms   
epoch 19  valid running_average 0.72437760647037  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s553ms   
epoch 20  running_average 0.73652605034834  
 [======================================== 370/370 ====================================>]  Tot: 8m12s | Step: 1s336ms   
epoch 20  valid running_average 0.70828594296306  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s536ms   
epoch 21  running_average 0.73054237722785  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s362ms   
epoch 21  valid running_average 0.71131892666077  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s546ms   
epoch 22  running_average 0.73120485532333  
 [======================================== 370/370 ====================================>]  Tot: 8m25s | Step: 1s369ms   
epoch 22  valid running_average 0.71093980369856  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s534ms   
epoch 23  running_average 0.73028593409411  
 [======================================== 370/370 ====================================>]  Tot: 8m22s | Step: 1s360ms   
epoch 23  valid running_average 0.71953325750874  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s586ms   
epoch 24  running_average 0.73193144420225  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s367ms   
epoch 24  valid running_average 0.72138674754623  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s575ms   
epoch 25  running_average 0.74216779929051  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s360ms   
epoch 25  valid running_average 0.72602047263996  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s584ms   
epoch 26  running_average 0.74137709962816  
 [======================================== 370/370 ====================================>]  Tot: 8m11s | Step: 1s331ms   
epoch 26  valid running_average 0.72762121403597  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s570ms   
epoch 27  running_average 0.73994529213147  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s334ms   
epoch 27  valid running_average 0.7237036100931 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s628ms   
epoch 28  running_average 0.73778689575587  
 [======================================== 370/370 ====================================>]  Tot: 8m25s | Step: 1s367ms   
epoch 28  valid running_average 0.7259362230928 
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s577ms   
epoch 29  running_average 0.74195409667906  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s362ms   
epoch 29  valid running_average 0.73086482160158  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s590ms   
epoch 30  running_average 0.74646322178057  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s336ms   
epoch 30  valid running_average 0.72829521041324  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s586ms   
epoch 31  running_average 0.75381459161431  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s365ms   
epoch 31  valid running_average 0.73524579805384  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s581ms   
epoch 32  running_average 0.75216908150618  
 [======================================== 370/370 ====================================>]  Tot: 8m11s | Step: 1s333ms   
epoch 32  valid running_average 0.73452967690299  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s578ms   
epoch 33  running_average 0.74975424199684  
 [======================================== 370/370 ====================================>]  Tot: 8m22s | Step: 1s358ms   
epoch 33  valid running_average 0.73709928809133  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s588ms   
epoch 34  running_average 0.74919861520708  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s333ms   
epoch 34  valid running_average 0.73027507477147  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s597ms   
epoch 35  running_average 0.7485361371116 
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s364ms   
epoch 35  valid running_average 0.73773115969502  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s572ms   
epoch 36  running_average 0.75214771124503  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s338ms   
epoch 36  valid running_average 0.73962677450609  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s598ms   
epoch 37  running_average 0.74736077274864  
 [======================================== 370/370 ====================================>]  Tot: 8m12s | Step: 1s336ms   
epoch 37  valid running_average 0.7324655629976 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s574ms   
epoch 38  running_average 0.75043809035346  
 [======================================== 370/370 ====================================>]  Tot: 8m22s | Step: 1s365ms   
epoch 38  valid running_average 0.73465605122373  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s602ms   
epoch 39  running_average 0.7522759328119 
 [======================================== 370/370 ====================================>]  Tot: 8m25s | Step: 1s365ms   
epoch 39  valid running_average 0.73874215426092  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s595ms   
epoch 40  running_average 0.75293841090738  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s362ms   
epoch 40  valid running_average 0.73819453220439  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s601ms   
epoch 41  running_average 0.7477240671881 
 [======================================== 370/370 ====================================>]  Tot: 8m26s | Step: 1s365ms   
epoch 41  valid running_average 0.73806815788365  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s600ms   
epoch 42  running_average 0.75445569944865  
 [======================================== 370/370 ====================================>]  Tot: 8m25s | Step: 1s365ms   
epoch 42  valid running_average 0.73676228990269  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s583ms   
epoch 43  running_average 0.7532803350857 
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s363ms   
epoch 43  valid running_average 0.73672016512911  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s575ms   
epoch 44  running_average 0.75073727400949  
 [======================================== 370/370 ====================================>]  Tot: 8m20s | Step: 1s359ms   
epoch 44  valid running_average 0.73242343822402  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s584ms   
epoch 45  running_average 0.75295978116853  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s364ms   
epoch 45  valid running_average 0.73962677450609  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s577ms   
epoch 46  running_average 0.74832243450015  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s366ms   
epoch 46  valid running_average 0.7387842790345 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s576ms   
epoch 47  running_average 0.75522502884985  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s364ms   
epoch 47  valid running_average 0.74030077088336  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s579ms   
epoch 48  running_average 0.75736205496431  
 [======================================== 370/370 ====================================>]  Tot: 8m11s | Step: 1s328ms   
epoch 48  valid running_average 0.74025864610978  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s568ms   
epoch 49  running_average 0.75454118049323  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s362ms   
epoch 49  valid running_average 0.74009014701546  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s591ms   
epoch 50  running_average 0.75268196777365  
 [======================================== 370/370 ====================================>]  Tot: 8m25s | Step: 1s368ms   
epoch 50  valid running_average 0.74063776907199  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s577ms   
epoch 51  running_average 0.75586613668419  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s337ms   
epoch 51  valid running_average 0.7412275159021 
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s612ms   
epoch 52  running_average 0.75122879001581  
 [======================================== 370/370 ====================================>]  Tot: 8m17s | Step: 1s345ms   
epoch 52  valid running_average 0.7412275159021 
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s589ms   
epoch 53  running_average 0.75396418344232  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s342ms   
epoch 53  valid running_average 0.73937402586461  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s597ms   
epoch 54  running_average 0.75567380433389  
 [======================================== 370/370 ====================================>]  Tot: 8m25s | Step: 1s369ms   
epoch 54  valid running_average 0.74051139475125  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s594ms   
epoch 55  running_average 0.75727657391973  
 [======================================== 370/370 ====================================>]  Tot: 8m27s | Step: 1s374ms   
epoch 55  valid running_average 0.74135389022284  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s586ms   
epoch 56  running_average 0.75556695302817  
 [======================================== 370/370 ====================================>]  Tot: 8m13s | Step: 1s335ms   
epoch 56  valid running_average 0.74320738026033  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s602ms   
epoch 57  running_average 0.75364362952515  
 [======================================== 370/370 ====================================>]  Tot: 8m15s | Step: 1s340ms   
epoch 57  valid running_average 0.74042714520409  
 [======================================== 731/731 ====================================>]  Tot: 1h19m | Step: 6s578ms   
epoch 58  running_average 0.7560157285122 
 [======================================== 370/370 ====================================>]  Tot: 8m18s | Step: 1s349ms   
epoch 58  valid running_average 0.7377732844686 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s587ms   
epoch 59  running_average 0.75830234645467  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s365ms   
epoch 59  valid running_average 0.73773115969502  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s589ms   
epoch 60  running_average 0.75242552463991  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s366ms   
epoch 60  valid running_average 0.73663591558195  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s598ms   
epoch 61  running_average 0.75511817754413  
 [======================================== 370/370 ====================================>]  Tot: 8m27s | Step: 1s369ms   
epoch 61  valid running_average 0.74089051771347  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s572ms   
epoch 62  running_average 0.75229730307304  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s366ms   
epoch 62  valid running_average 0.74282825729812  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s610ms   
epoch 63  running_average 0.75738342522546  
 [======================================== 370/370 ====================================>]  Tot: 8m29s | Step: 1s377ms   
epoch 63  valid running_average 0.74421837482623  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s605ms   
epoch 64  running_average 0.75513954780527  
 [======================================== 370/370 ====================================>]  Tot: 8m16s | Step: 1s344ms   
epoch 64  valid running_average 0.74316525548675  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s613ms   
epoch 65  running_average 0.75631491216823  
 [======================================== 370/370 ====================================>]  Tot: 8m29s | Step: 1s379ms   
epoch 65  valid running_average 0.74270188297738  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s618ms   
epoch 66  running_average 0.75868701115528  
 [======================================== 370/370 ====================================>]  Tot: 8m30s | Step: 1s381ms   
epoch 66  valid running_average 0.74232276001516  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s600ms   
epoch 67  running_average 0.75652861477967  
 [======================================== 370/370 ====================================>]  Tot: 8m27s | Step: 1s374ms   
epoch 67  valid running_average 0.74308100593959  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s609ms   
epoch 68  running_average 0.75939222977305  
 [======================================== 370/370 ====================================>]  Tot: 8m27s | Step: 1s375ms   
epoch 68  valid running_average 0.74404987573192  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s616ms   
epoch 69  running_average 0.75770397914262  
 [======================================== 370/370 ====================================>]  Tot: 8m28s | Step: 1s369ms   
epoch 69  valid running_average 0.74156451409074  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s611ms   
epoch 70  running_average 0.76065307518058  
 [======================================== 370/370 ====================================>]  Tot: 8m28s | Step: 1s372ms   
epoch 70  valid running_average 0.74089051771347  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s596ms   
epoch 71  running_average 0.75644313373509  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s367ms   
epoch 71  valid running_average 0.74417625005266  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s585ms   
epoch 72  running_average 0.75723383339744  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s363ms   
epoch 72  valid running_average 0.74190151227937  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s585ms   
epoch 73  running_average 0.75546010172244  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s362ms   
epoch 73  valid running_average 0.74118539112852  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s598ms   
epoch 74  running_average 0.75738342522546  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s365ms   
epoch 74  valid running_average 0.74181726273221  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s587ms   
epoch 75  running_average 0.76014018891311  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s366ms   
epoch 75  valid running_average 0.74084839293989  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s587ms   
epoch 76  running_average 0.76227721502757  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s360ms   
epoch 76  valid running_average 0.7436707527697 
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s593ms   
epoch 77  running_average 0.76022566995769  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s365ms   
epoch 77  valid running_average 0.74114326635494  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s601ms   
epoch 78  running_average 0.75808864384323  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s363ms   
epoch 78  valid running_average 0.74240700956232  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s591ms   
epoch 79  running_average 0.75930674872847  
 [======================================== 370/370 ====================================>]  Tot: 8m24s | Step: 1s368ms   
epoch 79  valid running_average 0.74350225367539  
 [======================================== 731/731 ====================================>]  Tot: 1h20m | Step: 6s584ms   
epoch 80  running_average 0.75789631149293  
 [======================================== 370/370 ====================================>]  Tot: 8m23s | Step: 1s366ms   
epoch 80  valid running_average 0.74295463161885  
 [======================================== 371/371 ====================================>]  Tot: 8m29s | Step: 1s374ms   
test running_average  0.73857473197393  



root@ip-172-31-15-65:~/workspace/GuessWhat-TemperedPolicyGradient# th reinforce.lua --DynamicTPG --tempMin 0.5 --tempMax 1.5 --epochs 80 --earlyStopThresh 20 --learningRate 0.001
{
  minLRate : 5e-05
  lookupDim : 300
  beamLen : 13
  learningRate : 0.001
  batchSize : 64
  random : false
  startEpoch : 1
  saveLastModel : false
  imgFeatureSize : 4096
  hiddenSize : 512
  bestValid : 0
  modelPath : "model/"
  data_qas : "data/data_qas.h5"
  imgEmbedSize : 300
  dropout : 0
  learningRateDecay : 1e-07
  deviceId : 1
  verbose : false
  beamSize : 5
  useCuda : true
  debug : false
  epochs : 80
  DynamicTPG : true
  loadModel : false
  prefix : "1"
  inputImg : "data/data_img.h5"
  earlyStopThresh : 20
  inputIndex : "data/id2index.json"
  round : 8
  inputJson : "data/vocab.json"
  tempMax : 1.5
  temperatures : "{1}"
  tempMin : 0.5
  saveModel : true
  trainGuesser : true
}
Using GPU:1 
 [======================================== 731/731 ====================================>]  Tot: 46m44s | Step: 3s823ms  
epoch 1 running_average 0.53171346753857  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s124ms   
epoch 1 valid running_average 0.52040945279919  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 43m9s | Step: 3s538ms   
epoch 2 running_average 0.57257340684703  
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s117ms   
epoch 2 valid running_average 0.55175028434222  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 43m4s | Step: 3s538ms   
epoch 3 running_average 0.5910586827371 
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s118ms   
epoch 3 valid running_average 0.59699229116643  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m57s | Step: 3s521ms  
epoch 4 running_average 0.62298585288712  
 [======================================== 370/370 ====================================>]  Tot: 6m49s | Step: 1s107ms   
epoch 4 valid running_average 0.61759130544673  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m48s | Step: 3s530ms  
epoch 5 running_average 0.64920716331154  
 [======================================== 370/370 ====================================>]  Tot: 6m49s | Step: 1s110ms   
epoch 5 valid running_average 0.6507013774801 
Saving model... 
utils.checkHistoryMemory: content wrong: = 470/74829====>...............................]  ETA: 15m19s | Step: 3s524ms  
 [======================================== 731/731 ====================================>]  Tot: 42m47s | Step: 3s521ms  
epoch 6 running_average 0.66267042783263  
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s112ms   
epoch 6 valid running_average 0.65402923459286  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m42s | Step: 3s512ms  
epoch 7 running_average 0.68243791939138  
 [======================================== 370/370 ====================================>]  Tot: 6m46s | Step: 1s101ms   
epoch 7 valid running_average 0.68545431568305  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s510ms  
epoch 8 running_average 0.69867931786126  
 [======================================== 370/370 ====================================>]  Tot: 6m46s | Step: 1s108ms   
epoch 8 valid running_average 0.68768692868276  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s510ms  
epoch 9 running_average 0.70412873445313  
 [======================================== 370/370 ====================================>]  Tot: 6m45s | Step: 1s97ms    
epoch 9 valid running_average 0.68772905345634  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s513ms  
epoch 10  running_average 0.70699234944651  
 [======================================== 370/370 ====================================>]  Tot: 6m49s | Step: 1s111ms   
epoch 10  valid running_average 0.702683348077  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s515ms  
epoch 11  running_average 0.71624567252212  
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s111ms   
epoch 11  valid running_average 0.70074560849235  
 [======================================== 731/731 ====================================>]  Tot: 42m55s | Step: 3s527ms  
epoch 12  running_average 0.71370261144591  
 [======================================== 370/370 ====================================>]  Tot: 6m57s | Step: 1s133ms   
epoch 12  valid running_average 0.71190867349088  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m52s | Step: 3s521ms  
epoch 13  running_average 0.72092575971278  
 [======================================== 370/370 ====================================>]  Tot: 6m48s | Step: 1s107ms   
epoch 13  valid running_average 0.70668520156704  
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s517ms  
epoch 14  running_average 0.71881010385947  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s117ms   
epoch 14  valid running_average 0.70521083449176  
 [======================================== 731/731 ====================================>]  Tot: 42m46s | Step: 3s505ms  
epoch 15  running_average 0.72453733384622  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s123ms   
epoch 15  valid running_average 0.70302034626564  
 [======================================== 731/731 ====================================>]  Tot: 42m34s | Step: 3s505ms  
epoch 16  running_average 0.72287045347694  
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s115ms   
epoch 16  valid running_average 0.71468890854712  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m39s | Step: 3s504ms  
epoch 17  running_average 0.72532803350857  
 [======================================== 370/370 ====================================>]  Tot: 6m43s | Step: 1s94ms    
epoch 17  valid running_average 0.70984455958549  
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s509ms  
epoch 18  running_average 0.72312689661068  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s116ms   
epoch 18  valid running_average 0.7159526517545 
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s505ms  
epoch 19  running_average 0.72761465145104  
 [======================================== 370/370 ====================================>]  Tot: 6m46s | Step: 1s100ms   
epoch 19  valid running_average 0.71738489405619  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m32s | Step: 3s501ms  
epoch 20  running_average 0.7321024062914 
 [======================================== 370/370 ====================================>]  Tot: 6m45s | Step: 1s98ms    
epoch 20  valid running_average 0.72534647626269  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m35s | Step: 3s507ms  
epoch 21  running_average 0.73319228960978  
 [======================================== 370/370 ====================================>]  Tot: 6m46s | Step: 1s101ms   
epoch 21  valid running_average 0.72041787775391  
 [======================================== 731/731 ====================================>]  Tot: 42m40s | Step: 3s510ms  
epoch 22  running_average 0.72622558447664  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s118ms   
epoch 22  valid running_average 0.72067062639538  
 [======================================== 731/731 ====================================>]  Tot: 42m34s | Step: 3s502ms  
epoch 23  running_average 0.73648330982605  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s116ms   
epoch 23  valid running_average 0.7261468469607 
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m33s | Step: 3s504ms  
epoch 24  running_average 0.72787109458478  
 [======================================== 370/370 ====================================>]  Tot: 6m47s | Step: 1s103ms   
epoch 24  valid running_average 0.72875858292262  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s506ms  
epoch 25  running_average 0.73994529213147  
 [======================================== 370/370 ====================================>]  Tot: 6m48s | Step: 1s108ms   
epoch 25  valid running_average 0.72896920679051  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s507ms  
epoch 26  running_average 0.73945377612514  
 [======================================== 370/370 ====================================>]  Tot: 6m48s | Step: 1s105ms   
epoch 26  valid running_average 0.71106617801929  
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s509ms  
epoch 27  running_average 0.734111210839  
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s115ms   
epoch 27  valid running_average 0.72037575298033  
 [======================================== 731/731 ====================================>]  Tot: 42m35s | Step: 3s508ms  
epoch 28  running_average 0.73451724580074  
 [======================================== 370/370 ====================================>]  Tot: 6m53s | Step: 1s120ms   
epoch 28  valid running_average 0.72315598803656  
 [======================================== 731/731 ====================================>]  Tot: 42m35s | Step: 3s501ms  
epoch 29  running_average 0.73742360131641  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s117ms   
epoch 29  valid running_average 0.71915413454653  
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s514ms  
epoch 30  running_average 0.7374663418387 
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s116ms   
epoch 30  valid running_average 0.72092337503686  
 [======================================== 731/731 ====================================>]  Tot: 42m43s | Step: 3s516ms  
epoch 31  running_average 0.74109928623328  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s122ms   
epoch 31  valid running_average 0.72783183790387  
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s511ms  
epoch 32  running_average 0.73697482583237  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s122ms   
epoch 32  valid running_average 0.72446185601752  
 [======================================== 731/731 ====================================>]  Tot: 42m44s | Step: 3s518ms  
epoch 33  running_average 0.74163354276189  
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s125ms   
epoch 33  valid running_average 0.7220607439235 
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s508ms  
epoch 34  running_average 0.74129161858358  
 [======================================== 370/370 ====================================>]  Tot: 6m53s | Step: 1s122ms   
epoch 34  valid running_average 0.72934832975273  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m42s | Step: 3s513ms  
epoch 35  running_average 0.74415523357695  
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s107ms   
epoch 35  valid running_average 0.72939045452631  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s504ms  
epoch 36  running_average 0.74832243450015  
 [======================================== 370/370 ====================================>]  Tot: 6m47s | Step: 1s105ms   
epoch 36  valid running_average 0.72993807658284  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m30s | Step: 3s498ms  
epoch 37  running_average 0.7443689361884 
 [======================================== 370/370 ====================================>]  Tot: 6m48s | Step: 1s107ms   
epoch 37  valid running_average 0.73280256118623  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m30s | Step: 3s498ms  
epoch 38  running_average 0.74005214343719  
 [======================================== 370/370 ====================================>]  Tot: 6m45s | Step: 1s99ms    
epoch 38  valid running_average 0.72589409831922  
 [======================================== 731/731 ====================================>]  Tot: 42m32s | Step: 3s499ms  
epoch 39  running_average 0.73973158952002  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s118ms   
epoch 39  valid running_average 0.7245039807911 
 [======================================== 731/731 ====================================>]  Tot: 42m31s | Step: 3s499ms  
epoch 40  running_average 0.74144121041159  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s117ms   
epoch 40  valid running_average 0.7269472176587 
 [======================================== 731/731 ====================================>]  Tot: 42m29s | Step: 3s498ms  
epoch 41  running_average 0.74310809078087  
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s113ms   
epoch 41  valid running_average 0.73027507477147  
 [======================================== 731/731 ====================================>]  Tot: 42m33s | Step: 3s505ms  
epoch 42  running_average 0.74642048125828  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s116ms   
epoch 42  valid running_average 0.73537217237457  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m31s | Step: 3s501ms  
epoch 43  running_average 0.74819421293328  
 [======================================== 370/370 ====================================>]  Tot: 6m47s | Step: 1s102ms   
epoch 43  valid running_average 0.7363410421669 
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m31s | Step: 3s502ms  
epoch 44  running_average 0.74682651622003  
 [======================================== 370/370 ====================================>]  Tot: 6m47s | Step: 1s102ms   
epoch 44  valid running_average 0.73174944184675  
 [======================================== 731/731 ====================================>]  Tot: 42m32s | Step: 3s500ms  
epoch 45  running_average 0.73680386374321  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s118ms   
epoch 45  valid running_average 0.71123467711361  
 [======================================== 731/731 ====================================>]  Tot: 42m34s | Step: 3s499ms  
epoch 46  running_average 0.73220925759713  
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s114ms   
epoch 46  valid running_average 0.72307173848941  
 [======================================== 731/731 ====================================>]  Tot: 42m32s | Step: 3s501ms  
epoch 47  running_average 0.73156814976279  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s119ms   
epoch 47  valid running_average 0.71300391760394  
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s508ms  
epoch 48  running_average 0.73622686669231  
 [======================================== 370/370 ====================================>]  Tot: 6m53s | Step: 1s120ms   
epoch 48  valid running_average 0.72277686507435  
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s512ms  
epoch 49  running_average 0.73594905329743  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s123ms   
epoch 49  valid running_average 0.72302961371583  
 [======================================== 731/731 ====================================>]  Tot: 42m40s | Step: 3s509ms  
epoch 50  running_average 0.73312817882635  
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s125ms   
epoch 50  valid running_average 0.7273684653945 
 [======================================== 731/731 ====================================>]  Tot: 42m35s | Step: 3s504ms  
epoch 51  running_average 0.73669701243749  
 [======================================== 370/370 ====================================>]  Tot: 6m52s | Step: 1s117ms   
epoch 51  valid running_average 0.72302961371583  
 [======================================== 731/731 ====================================>]  Tot: 42m35s | Step: 3s505ms  
epoch 52  running_average 0.74686925674232  
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s126ms   
epoch 52  valid running_average 0.73570917056321  
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s514ms  
epoch 53  running_average 0.75007479591401  
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s128ms   
epoch 53  valid running_average 0.73486667509162  
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s503ms  
epoch 54  running_average 0.75167756549985  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s122ms   
epoch 54  valid running_average 0.73954252495893  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m33s | Step: 3s503ms  
epoch 55  running_average 0.75498995597726  
 [======================================== 370/370 ====================================>]  Tot: 6m46s | Step: 1s103ms   
epoch 55  valid running_average 0.73882640380808  
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s513ms  
epoch 56  running_average 0.75323759456341  
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s133ms   
epoch 56  valid running_average 0.74030077088336  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s505ms  
epoch 57  running_average 0.75225456255075  
 [======================================== 370/370 ====================================>]  Tot: 6m49s | Step: 1s108ms   
epoch 57  valid running_average 0.72909558111125  
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s509ms  
epoch 58  running_average 0.7510791981878 
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s122ms   
epoch 58  valid running_average 0.73482455031804  
 [======================================== 731/731 ====================================>]  Tot: 42m39s | Step: 3s514ms  
epoch 59  running_average 0.75531050989443  
 [======================================== 370/370 ====================================>]  Tot: 6m57s | Step: 1s127ms   
epoch 59  valid running_average 0.73853153039302  
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s504ms  
epoch 60  running_average 0.75364362952515  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s120ms   
epoch 60  valid running_average 0.73983739837398  
 [======================================== 731/731 ====================================>]  Tot: 42m35s | Step: 3s507ms  
epoch 61  running_average 0.75622943112365  
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s126ms   
epoch 61  valid running_average 0.74156451409074  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s505ms  
epoch 62  running_average 0.75466940206009  
 [======================================== 370/370 ====================================>]  Tot: 6m49s | Step: 1s109ms   
epoch 62  valid running_average 0.74084839293989  
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s504ms  
epoch 63  running_average 0.75396418344232  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s124ms   
epoch 63  valid running_average 0.74350225367539  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m34s | Step: 3s509ms  
epoch 64  running_average 0.75605846903449  
 [======================================== 370/370 ====================================>]  Tot: 6m49s | Step: 1s108ms   
epoch 64  valid running_average 0.74278613252454  
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s515ms  
epoch 65  running_average 0.75988374577937  
 [======================================== 370/370 ====================================>]  Tot: 6m58s | Step: 1s130ms   
epoch 65  valid running_average 0.74628248873162  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s511ms  
epoch 66  running_average 0.76001196734624  
 [======================================== 370/370 ====================================>]  Tot: 6m48s | Step: 1s103ms   
epoch 66  valid running_average 0.74257550865664  
 [======================================== 731/731 ====================================>]  Tot: 42m40s | Step: 3s510ms  
epoch 67  running_average 0.7568277984357 
 [======================================== 370/370 ====================================>]  Tot: 6m55s | Step: 1s122ms   
epoch 67  valid running_average 0.74594549054299  
 [======================================== 731/731 ====================================>]  Tot: 42m39s | Step: 3s508ms  
epoch 68  running_average 0.75866564089413  
 [======================================== 370/370 ====================================>]  Tot: 6m53s | Step: 1s117ms   
epoch 68  valid running_average 0.74628248873162  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s511ms  
epoch 69  running_average 0.7575971278369 
 [======================================== 370/370 ====================================>]  Tot: 6m50s | Step: 1s113ms   
epoch 69  valid running_average 0.74232276001516  
 [======================================== 731/731 ====================================>]  Tot: 42m45s | Step: 3s513ms  
epoch 70  running_average 0.75967004316793  
 [======================================== 370/370 ====================================>]  Tot: 6m58s | Step: 1s133ms   
epoch 70  valid running_average 0.74299675639243  
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s509ms  
epoch 71  running_average 0.75800316279865  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s122ms   
epoch 71  valid running_average 0.74207001137369  
 [======================================== 731/731 ====================================>]  Tot: 42m39s | Step: 3s507ms  
epoch 72  running_average 0.76046074283028  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s122ms   
epoch 72  valid running_average 0.74202788660011  
 [======================================== 731/731 ====================================>]  Tot: 42m36s | Step: 3s505ms  
epoch 73  running_average 0.76099499935889  
 [======================================== 370/370 ====================================>]  Tot: 6m51s | Step: 1s117ms   
epoch 73  valid running_average 0.74476599688277  
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s506ms  
epoch 74  running_average 0.76033252126341  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s120ms   
epoch 74  valid running_average 0.74480812165635  
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s506ms  
epoch 75  running_average 0.76261913920588  
 [======================================== 370/370 ====================================>]  Tot: 6m54s | Step: 1s123ms   
epoch 75  valid running_average 0.74375500231686  
 [======================================== 731/731 ====================================>]  Tot: 42m42s | Step: 3s522ms  
epoch 76  running_average 0.76279010129504  
 [======================================== 370/370 ====================================>]  Tot: 6m57s | Step: 1s128ms   
epoch 76  valid running_average 0.7463246135052 
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m41s | Step: 3s517ms  
epoch 77  running_average 0.76360217121853  
 [======================================== 370/370 ====================================>]  Tot: 6m47s | Step: 1s103ms   
epoch 77  valid running_average 0.74834660263701  
Saving model... 
 [======================================== 731/731 ====================================>]  Tot: 42m35s | Step: 3s506ms  
epoch 78  running_average 0.76184980980468  
 [======================================== 370/370 ====================================>]  Tot: 6m45s | Step: 1s99ms    
epoch 78  valid running_average 0.74455537301487  
 [======================================== 731/731 ====================================>]  Tot: 42m37s | Step: 3s503ms  
epoch 79  running_average 0.75990511604052  
 [======================================== 370/370 ====================================>]  Tot: 6m53s | Step: 1s121ms   
epoch 79  valid running_average 0.74607186486373  
 [======================================== 731/731 ====================================>]  Tot: 42m38s | Step: 3s512ms  
epoch 80  running_average 0.76347394965166  
 [======================================== 370/370 ====================================>]  Tot: 6m56s | Step: 1s129ms   
epoch 80  valid running_average 0.74683011078815  
 [======================================== 371/371 ====================================>]  Tot: 7m368ms | Step: 1s136ms 
test running_average  0.74307336556653